<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Immobili in Vendita</title>
  <link rel="stylesheet" href="/css/immobili.css">
</head>
<body>
<header>
  <nav>
    <div class="logo">Immobiliare</div>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="immobili">Proprietà</a></li>
      <li><a href="contatti">Contatti</a></li>
      <li><a id="user-button" href="accesso">Accedi</a></li>
    </ul>
  </nav>
</header>
<main>
  <section class="properties-section">
    <h1>Appartamenti</h1>
    <div class="property-list">
      <div class="property-item">
        <img src="css/images/property1.jpg" alt="Appartamento 1">
        <h3>Appartamento in centro</h3>
        <p>3 camere, 2 bagni, 120m²</p>
      </div>
      <div class="property-item">
        <img src="css/images/property2.jpg" alt="Appartamento 2">
        <h3>Appartamento moderno</h3>
        <p>2 camere, 1 bagno, 90m²</p>
      </div>
      <!-- Aggiungi altri appartamenti qui -->
    </div>
  </section>

  <section class="properties-section">
    <h2>Ville</h2>
    <div class="property-list">
      <div class="property-item">
        <img src="css/images/property1.jpg" alt="Villa 1">
        <h3>Villa con giardino</h3>
        <p>5 camere, 3 bagni, 250m²</p>
      </div>
      <div class="property-item">
        <img src="css/images/property1.jpg" alt="Villa 2">
        <h3>Villa moderna</h3>
        <p>4 camere, 3 bagni, 200m²</p>
      </div>
      <!-- Aggiungi altre ville qui -->
    </div>
  </section>

  <section class="properties-section">
    <h2>Box Auto</h2>
    <div class="property-list">
      <div class="property-item">
        <img src="css/images/property3.jpg" alt="Box Auto 1">
        <h3>Box auto spazioso</h3>
        <p>20m²</p>
      </div>
      <div class="property-item">
        <img src="css/images/hero-image.jpg" alt="Box Auto 2">
        <h3>Box auto doppio</h3>
        <p>40m²</p>
      </div>
      <!-- Aggiungi altri box auto qui -->
    </div>
  </section>

  <section class="properties-section">
    <h2>Terreni Edificabili</h2>
    <div class="property-list">
      <div class="property-item">
        <img src="css/images/hero-image.jpg" alt="Terreno Edificabile 1">
        <h3>Terreno edificabile</h3>
        <p>1000m²</p>
      </div>
      <div class="property-item">
        <img src="css/images/hero-image.jpg" alt="Terreno Edificabile 2">
        <h3>Terreno agricolo</h3>
        <p>2000m²</p>
      </div>
      <!-- Aggiungi altri terreni edificabili qui -->
    </div>
  </section>
</main>
<footer>
  <p>&copy; 2024 Immobiliare. Tutti i diritti riservati.</p>
</footer>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    // Funzione per verificare lo stato di login e aggiornare il pulsante
    function checkAndUpdateLoginStatus() {
      var sessionToken = localStorage.getItem('sessionToken');
      if (sessionToken) {
        $.ajax({
          url: '/auth/checkLogin',
          method: 'GET',
          headers: { 'Authorization': 'Bearer ' + sessionToken },
          success: function(response) {
            if (response) {
              $('#user-button').text('Profilo').attr('href', '/profile');
            } else {
              localStorage.removeItem('sessionToken');
              $('#user-button').text('Accedi').attr('href', 'accesso');
            }
          },
          error: function(xhr, status, error) {
            console.error('Errore durante la verifica dello stato di login:', error);
          }
        });
      } else {
        $('#user-button').text('Accedi').attr('href', 'accesso');
      }
    }

    // Chiamata per verificare lo stato di login quando la pagina è caricata
    checkAndUpdateLoginStatus();

    // Evento click sul pulsante di logout
    $('#logout-button').click(function(event) {
      event.preventDefault();
      $.ajax({
        url: '/auth/doLogout',
        method: 'GET',
        success: function(response) {
          console.log(response);
          localStorage.removeItem('sessionToken');
          $('#user-button').text('Accedi').attr('href', 'accesso');
          // Altri eventuali aggiustamenti UI dopo il logout
        },
        error: function(xhr, status, error) {
          console.error('Errore durante il logout:', error);
          alert('Errore durante il logout. Si prega di riprovare.');
        }
      });
    });
  });
</script>

</html>
